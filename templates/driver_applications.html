{% extends "base.html" %}
{% block title %}My Applications{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex align-items-center justify-content-between mb-2">
    <h2 class="mb-0">My Applications</h2>
  </div>

  {% if applications and applications|length > 0 %}
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th>Sponsor</th>
          <th>Status</th>
          <th>Applied On</th>
          <th>Last Updated</th>
          <th class="text-end" style="width: 160px;">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for app in applications %}
        <tr>
          <td class="fw-semibold">{{ app.sponsor }}</td>
          <td>
            {% if app.status == "pending" %}
              <span class="badge bg-warning text-dark">Pending</span>
            {% elif app.status == "accepted" %}
              <span class="badge bg-success">Accepted</span>
            {% elif app.status == "rejected" %}
              <span class="badge bg-danger">Rejected</span>
            {% else %}
              <span class="badge bg-secondary">Withdrawn</span>
            {% endif %}
          </td>
          <td>{{ app.created_at or '-' }}</td>
          <td>{{ app.updated_at or '-' }}</td>
          <td class="text-end">
            {% if app.status == "pending" %}
              <form method="POST" action="{{ url_for('withdraw_application', app_id=app.id) }}" class="d-inline m-0"
                    onsubmit="return confirm('Are you sure you want to withdraw your application to {{ app.sponsor }}?');">
                <button type="submit" class="btn btn-outline-warning btn-sm">Withdraw</button>
              </form>
            {% else %}
              <span class="text-muted">No actions</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <div class="alert alert-secondary mt-3" role="alert">
      You havenâ€™t submitted any applications yet.
    </div>
  {% endif %}
</div>
{% endblock %}
